!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("Avalon requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){function c(){avalon.config.debug&&console.log.apply(console,arguments)}function d(){return Object.create(null)}function e(){}function f(a,b){"string"==typeof a&&(a=a.match(wb)||[]);for(var c={},d=void 0!==b?b:1,e=0,f=a.length;f>e;e++)c[a[e]]=d;return c}function g(){if(a.VBArray){var b=document.documentMode;return b?b:a.XMLHttpRequest?7:6}return 0/0}function h(a){if(a&&"object"==typeof a){var b=a.length,c=Cb.call(a);if(/(Array|List|Collection|Map|Arguments)\]$/.test(c))return!0;if("[object Object]"===c&&b===b>>>0)return!0}return!1}function i(a,b){if(a&&a.childNodes)for(var c,d=a.childNodes,e=0;c=d[e++];)if(c.tagName){var f=rb.createElementNS(Qb,c.tagName.toLowerCase());Db.forEach.call(c.attributes,function(a){f.setAttribute(a.name,a.value)}),i(c,f),b.appendChild(f)}}function j(a){for(var b in a)if(Bb.call(a,b)){var c=a[b];"function"==typeof j.plugins[b]?j.plugins[b](c):"object"==typeof j[b]?avalon.mix(j[b],c):j[b]=c}return this}function k(a){return(a+"").replace(Yb,"\\$&")}function l(a,b,c){if(Array.isArray(a)){var e=a.concat();a.length=0;var f=v(a);return f.pushArray(e),f}if(!a||a.$id&&a.$events||a.nodeName&&a.nodeType>0)return a;var g=Array.isArray(a.$skipArray)?a.$skipArray:[];g.$special=b||d();var h={};c=c||{};var i=d(),j=d(),k=[];bc.forEach(function(b){delete a[b]});var l=Object.keys(a);l.forEach(function(b,d){var e=a[b];if(c[b]=e,u(b,e,g)){i[b]=[];var f=avalon.type(e);"object"===f&&Mb(e.get)&&Object.keys(e).length<=2?(d=p(b,e),k.push(d)):d=xb.test(f)?q(b,e,f,i[b],c):o(b,e),j[b]=d}}),h=Object.defineProperties(h,dc(j));for(var n=0;n<l.length;n++){var r=l[n];j[r]||(h[r]=a[r])}m(h,"$id",Kb()),m(h,"$model",c),m(h,"$events",i),m(h,"hasOwnProperty",function(a){return a in this.$model});for(n in _b)m(h,n,_b[n]);return h.$reinitialize=function(){k.forEach(function(a){delete a._value,delete a.oldArgs,a.digest=function(){a.call(h)},gc.begin({callback:function(b,c){var d=c._name;if(c!==a){var e=b.$events[d];a.vm=h,y(e,a.digest)}}});try{a.get.call(h)}finally{gc.end()}})},h.$reinitialize(),h}function m(a,b,c){Object.defineProperty(a,b,{value:c,writable:!0,enumerable:!1,configurable:!0})}function n(a){for(var b=Object.keys(a),c=0;c<bc.length;c++){var d=b.indexOf(bc[c]);-1!==d&&b.splice(d,1)}return b}function o(a,b){function c(a){var b=c._value;return arguments.length>0?(vb||cc(a,b)||(c.updateValue(this,a),c.notify(this,a,b)),this):(gc.collectDependency(this,c),b)}return t(c,a),c._value=b,c}function p(a,b){function c(b){var d=c._value,e="_value"in c;if(arguments.length>0){if(vb)return this;if("function"==typeof c.set&&c.oldArgs!==b){c.oldArgs=b;var f=this.$events,g=f[a];f[a]=[],c.set.call(this,b),f[a]=g,b=c.get.call(this),b!==d&&(c.updateValue(this,b),c.notify(this,b,d))}return this}return b=c.get.call(this),c.updateValue(this,b),e&&d!==b&&c.notify(this,b,d),b}return c.set=b.set,c.get=b.get,t(c,a),c}function q(a,b,c,d,e){function f(b){var d=f._value,e=f._vmodel;if(arguments.length>0){if(vb)return this;if("array"===c){var g=e,h=b,i=g.length,j=h.length;g.$lock=!0,i>j?g.splice(j,i-j):j>i&&g.push.apply(g,h.slice(i));for(var k=Math.min(i,j),m=0;k>m;m++)g.set(m,h[m]);delete g.$lock,g._fire("set")}else if("object"===c){b=b.$model?b.$model:b;var n=this.$events[a]||[],o=avalon.mix(!0,{},b);for(m in e)e.hasOwnProperty(m)&&Bb.call(o,m)&&(e[m]=o[m]);e=f._vmodel=l(b),e.$events[ub]=n,n.length&&n.forEach(function(a){a.type&&(a.rollback&&a.rollback(),Nb[a.type](a,a.vmodels))})}return f.updateValue(this,e.$model),f.notify(this,this._value,d),this}return gc.collectDependency(this,f),e}t(f,a),e[a]=Array.isArray(b)?b:e[a]||{};var g=f._vmodel=l(b,0,e[a]);return g.$events[ub]=d,f}function r(a,b){a.$model[this._name]=this._value=b}function s(a,b,c){var d=this._name,e=a.$events[d];e&&(z(e),_b.$fire.call(a,d,b,c))}function t(a,b){a._name=b,a.updateValue=r,a.notify=s}function u(a,b,c){if(Mb(b)||b&&b.nodeName&&b.nodeType>0)return!1;if(-1!==c.indexOf(a))return!1;var d=c.$special;return a&&"$"===a.charAt(0)&&!d[a]?!1:!0}function v(a){var b=[];b.$id=Kb(),b.$model=a,b.$events={},b.$events[ub]=[],b._=l({length:a.length}),b._.$watch("length",function(a,c){b.$fire("length",a,c)});for(var c in _b)b[c]=_b[c];return avalon.mix(b,fc),b}function w(a,b,c,d,e,f,g){for(var h=this.length,i=2;--i;){switch(a){case"add":var j=this.$model.slice(b,b+c).map(function(a){return xb.test(avalon.type(a))?a.$id?a:l(a,0,a):a});ec.apply(this,[b,0].concat(j)),this._fire("add",b,c);break;case"del":var k=this._splice(b,c);this._fire("del",b,c)}e&&(a=e,b=f,c=g,i=2,e=0)}return this._fire("index",d),this.length!==h&&(this._.length=this.length),k}function x(a,b){for(var c={},d=0,e=b.length;e>d;d++){c[d]=a[d];var f=b[d];f in c?(a[d]=c[f],delete c[f]):a[d]=a[f]}}function y(a,b){b.oneTime||a&&avalon.Array.ensure(a,b)&&b.element&&(B(b,a),new Date-kc>444&&C())}function z(a){if(a&&a.length){new Date-kc>444&&"object"==typeof a[0]&&C();for(var b,c=Eb.call(arguments,1),d=a.length;b=a[--d];){var e=b.element;if(e&&e.parentNode)try{var f=b.evaluator;if(b.$repeat)b.handler.apply(b,c);else if("$repeat"in b||!f)Nb[b.type](b,b.vmodels);else if("on"!==b.type){var g=f.apply(0,b.args||[]);b.handler(g,e,b)}}catch(h){console.log(h)}}}}function A(a,b){return a.uuid||b||(a.uuid=++ic),a.uuid}function B(a,b){var c=a.element;a.uuid||(a.uuid=1!==c.nodeType?a.type+A(c.parentNode)+"-"+ ++ic:a.name+"-"+A(c));var d=a.lists||(a.lists=[]);avalon.Array.ensure(d,b),b.$uuid=b.$uuid||Kb(),jc[a.uuid]||(jc[a.uuid]=1,jc.push(a))}function C(a){if(!avalon.optimize){for(var b=jc.length,c=b,d=[],e={},f={};a=jc[--b];){var g=a.type;f[g]?f[g]++:(f[g]=1,d.push(g))}var h=!1;if(d.forEach(function(a){lc[a]!==f[a]&&(e[a]=1,h=!0)}),b=c,h)for(;a=jc[--b];)if(null!==a.element){if(e[a.type]&&E(a.element)){jc.splice(b,1),delete jc[a.uuid];for(var i,j=a.lists,k=0;i=j[k++];)avalon.Array.remove(j,i),avalon.Array.remove(i,a);D(a)}}else jc.splice(b,1);lc=f,kc=new Date}}function D(a){delete jc[a.uuid],a.element=null,a.rollback&&a.rollback();for(var b in a)a[b]=null}function E(a){try{{a.parentNode.nodeType}}catch(b){return!0}return a.ifRemove&&!Gb.contains(a.ifRemove)&&tb===a.parentNode?(a.parentNode&&a.parentNode.removeChild(a),!0):a.msRetain?0:1===a.nodeType?!Gb.contains(a):!avalon.contains(Gb,a)}function F(a){return a.replace(/([a-z\d])([A-Z]+)/g,"$1-$2").toLowerCase()}function G(a){return a.indexOf("-")<0&&a.indexOf("_")<0?a:a.replace(/[-_][^-_]/g,function(a){return a.charAt(1).toUpperCase()})}function H(a){try{if("object"==typeof a)return a;a="true"===a?!0:"false"===a?!1:"null"===a?null:+a+""===a?+a:sc.test(a)?JSON.parse(a):a}catch(b){}return a}function I(a){return a.window&&a.document?a:9===a.nodeType?a.defaultView:!1}function J(a,b){if(a.offsetWidth<=0){var c=getComputedStyle(a,null);if(xc.test(c.display)){var d={node:a};for(var e in wc)d[e]=c[e],a.style[e]=wc[e];b.push(d)}var f=a.parentNode;f&&1===f.nodeType&&J(f,b)}}function K(a){var b=a.tagName.toLowerCase();return"input"===b&&/checkbox|radio/.test(a.type)?"checked":b}function L(a,b,c,d){for(var e,f=[],g=" = "+c+".",h=a.length;e=a[--h];)b.hasOwnProperty(e)&&(f.push(e+g+e),d.vars.push(e),"duplex"===d.type&&(a.get=c+"."+e),a.splice(h,1));return f}function M(a){for(var b=[],c={},d=0;d<a.length;d++){var e=a[d],f=e&&"string"==typeof e.$id?e.$id:e;c[f]||(c[f]=b.push(e))}return b}function N(a,b){return b=b.replace(Lc,"").replace(Mc,function(){return"],|"}).replace(Nc,function(a,b){return"["+zc(b)}).replace(Oc,function(){return'"],["'}).replace(Pc,function(){return'",'})+"]","return this.filters.$filter("+a+", "+b+")"}function O(a,b,d){var f=d.type,g=d.filters||"",h=b.map(function(a){return String(a.$id).replace(Kc,"$1")})+a+f+g,i=Hc(a).concat(),j=[],k=[],l=[],m="";b=M(b),d.vars=[];for(var n=0,o=b.length;o>n;n++)if(i.length){var p="vm"+qb+"_"+n;k.push(p),l.push(b[n]),j.push.apply(j,L(i,b[n],p,d))}if(j.length||"duplex"!==f){"duplex"!==f&&(a.indexOf("||")>-1||a.indexOf("&&")>-1)&&d.vars.forEach(function(b){var c=new RegExp("\\b"+b+"(?:\\.\\w+|\\[\\w+\\])+","ig");a=a.replace(c,function(c,d){var e=c.charAt(b.length),f=a.slice(d+c.length),g=/^\s*\(/.test(f);if("."===e||"["===e||g){var h="var"+String(Math.random()).replace(/^0\./,"");if(g){var i=c.split(".");if(i.length>2){var k=i.pop();return j.push(h+" = "+i.join(".")),h+"."+k}return c}return j.push(h+" = "+c),h}return c})}),d.args=l,delete d.vars;var q=Ic.get(h);if(q)return void(d.evaluator=q);if(m=j.join(", "),m&&(m="var "+m),/\S/.test(g)){if(!/text|html/.test(d.type))throw Error("ms-"+d.type+"不支持过滤器");a="\nvar ret"+qb+" = "+a+";\r\n",a+=N("ret"+qb,g);try{q=Function.apply(e,k.concat("'use strict';\n"+m+a)),d.evaluator=Ic.put(h,function(){return q.apply(avalon,arguments)})}catch(r){c("debug: parse error,"+r.message)}return void(i=j=k=null)}if("duplex"===f){var s="'use strict';\nreturn function(vvv){\n	"+m+";\n	if(!arguments.length){\n		return "+a+"\n	}\n	"+(Jc.test(a)?a:i.get)+"= vvv;\n} ";try{q=Function.apply(e,k.concat(s)),d.evaluator=Ic.put(h,q)}catch(r){c("debug: parse error,"+r.message)}return void(i=j=k=null)}if("on"===f){-1===a.indexOf("(")?a+=".call(this, $event)":a=a.replace("(",".call(this,"),k.push("$event"),a="\nreturn "+a+";";var t=a.lastIndexOf("\nreturn"),u=a.slice(0,t),v=a.slice(t);a=u+"\n"+v}else a="\nreturn "+a+";";try{q=Function.apply(e,k.concat("'use strict';\n"+m+a)),d.evaluator=Ic.put(h,q)}catch(r){c("debug: parse error,"+r.message)}i=j=k=null}}function P(a){var b=Vb.test(a);if(b){var c=$(a);return 1===c.length?c[0].value:c.map(function(a){return a.expr?"("+a.value+")":zc(a.value)}).join(" + ")}return a}function Q(a,b,c,d){a=a||"",O(a,b,c),c.evaluator&&!d&&(c.handler=Ob[c.handlerName||c.type],avalon.injectBinding(c))}function R(a,b,c){var d=setTimeout(function(){var e=a.innerHTML;clearTimeout(d),e===c?b():R(a,b,e)})}function S(a,b){var c=a.getAttribute("avalonctrl")||b.$id;a.setAttribute("avalonctrl",c),b.$events.expr=a.tagName+'[avalonctrl="'+c+'"]'}function T(a,b){for(var c,d=0;c=a[d++];)c.vmodels=b,Nb[c.type](c,b),c.evaluator&&c.element&&1===c.element.nodeType&&c.element.removeAttribute(c.name);a.length=0}function U(a,b){return a.priority-b.priority}function V(a,b,e){var f=!0;if(b.length){for(var g,h=a.attributes,i=[],j=[],k={},l=d(),m=0;g=h[m++];)if(g.specified&&(e=g.name.match(Uc))){var n=e[1],o=e[2]||"",p=g.value,q=g.name;if(k[q])continue;if(k[q]=1,Wc[n]?(o=n,n="on"):Xc[n]&&("enabled"===n&&(c("warning!ms-enabled或ms-attr-enabled已经被废弃"),n="disabled",p="!("+p+")"),o=n,n="attr",q="ms-"+n+"-"+o,j.push([g.name,q,p])),l[q]=p,"function"==typeof Nb[n]){var r=p.replace(Tc,""),s=p!==r,t={type:n,param:o,element:a,name:q,value:r,oneTime:s,priority:(Vc[n]||10*n.charCodeAt(0))+(Number(o.replace(/\D/g,""))||0)};if("html"===n||"text"===n){var u=Z(p);avalon.mix(t,u),t.filters=t.filters.replace($c,function(){return t.type="html",t.group=1,""})}else if("duplex"===n)var v=q;else"ms-if-loop"===q&&(t.priority+=100);i.push(t),"widget"===n&&(a.msData=a.msData||l)}}if(i.length){i.sort(U),j.forEach(function(b){c("warning!请改用"+b[1]+"代替"+b[0]+"!"),a.removeAttribute(b[0]),a.setAttribute(b[1],b[2])});var w=a.type;for(w&&v&&l["ms-attr-value"]&&"text"===a.type&&c("warning!"+w+"控件不能同时定义ms-attr-value与"+v),m=0;t=i[m];m++){if(n=t.type,Yc.test(n))return T(i.slice(0,m+1),b);f&&(f=!Zc.test(n))}T(i,b)}}f&&!Qc[a.tagName]&&Xb.test(a.innerHTML+a.textContent)&&(Sc&&Sc(a),W(a,b))}function W(a,b){var c=avalon.slice(a.childNodes);X(c,b)}function X(a,b){for(var c,d=0;c=a[d++];)switch(c.nodeType){case 1:Y(c,b),c.msCallback&&(c.msCallback(),c.msCallback=void 0);break;case 3:Vb.test(c.nodeValue)&&_(c,b,d)}}function Y(a,b,c){var d=a.getAttribute("ms-skip"),e=a.getAttributeNode("ms-important"),f=a.getAttributeNode("ms-controller");if("string"!=typeof d){if(c=e||f){var g=avalon.vmodels[c.value];if(!g)return;b=c===e?[g]:[g].concat(b),a.removeAttribute(c.name),a.classList.remove(c.name),S(a,g)}V(a,b)}}function Z(a){if(a.indexOf("|")>0){var b=a.replace(ad,function(a){return Array(a.length+1).join("1")}),c=b.replace(_c,"ᄢ㍄").indexOf("|");if(c>-1)return{filters:a.slice(c),value:a.slice(0,c),expr:!0}}return{value:a,filters:"",expr:!0}}function $(a){for(var b,c,d=[],e=0;;){if(c=a.indexOf(Tb,e),-1===c)break;if(b=a.slice(e,c),b&&d.push({value:b,filters:"",expr:!1}),e=c+Tb.length,c=a.indexOf(Ub,e),-1===c)break;b=a.slice(e,c),b&&d.push(Z(b)),e=c+Ub.length}return b=a.slice(e),b&&d.push({value:b,expr:!1,filters:""}),d}function _(a,b){var c=[],d=$(a.data);if(d.length){for(var e,f=0;e=d[f++];){var g=rb.createTextNode(e.value);e.expr&&(e.value=e.value.replace(Tc,function(){return e.oneTime=!0,""}),e.type="text",e.element=g,e.filters=e.filters.replace($c,function(){return e.type="html",""}),c.push(e)),Hb.appendChild(g)}a.parentNode.replaceChild(Hb,a),c.length&&T(c,b)}}function ab(a,b,c){var d=a.templateCache&&a.templateCache[b];if(d){for(var e,f=rb.createDocumentFragment();e=d.firstChild;)f.appendChild(e);return f}return avalon.parseHTML(c)}function bb(a){return null==a?"":a}function cb(a,b,c){return b.param.replace(/\w+/g,function(d){var e=avalon.duplexHooks[d];e&&"function"==typeof e[c]&&(a=e[c](a,b))}),a}function db(){for(var a=ld.length-1;a>=0;a--){var b=ld[a];b()===!1&&ld.splice(a,1)}ld.length||clearInterval(kd)}function eb(a,b,c,d){var e=a.template.cloneNode(!0),f=avalon.slice(e.childNodes);e.insertBefore(rb.createComment(a.signature),e.firstChild),b.appendChild(e);var g=[c].concat(a.vmodels),h={nodes:f,vmodels:g};d.push(h)}function fb(a){for(var b,c=[],d=a.element.parentNode.childNodes,e=0;b=d[e++];)if(b.nodeValue===a.signature)c.push(b);else if(b.nodeValue===a.signature+":end")break;return c}function gb(a,b,c){for(;;){var d=b.previousSibling;if(!d)break;if(d.parentNode.removeChild(d),c&&c.call(d),d===a)break}}function hb(){var a=l({$key:"",$outer:{},$host:{},$val:{get:function(){return this.$host[this.$key]},set:function(a){this.$host[this.$key]=a}}},{$val:1});return a.$id=Kb("$proxy$with"),a}function ib(a,b,c){a=a||pd.pop(),a?a.$reinitialize():a=hb();var d=c.$repeat;return a.$key=b,a.$host=d,a.$outer=c.$outer,d.$events?a.$events.$val=d.$events[b]:a.$events={},a}function jb(a){kb(a)}function kb(a){a.forEach(function(a){nb(a,qd)}),a.length=0}function lb(a){var b={$host:[],$outer:{},$index:0,$first:!1,$last:!1,$remove:avalon.noop};b[a]={get:function(){var b=this.$events,c=b.$index;b.$index=b[a];try{return this.$host[this.$index]}finally{b.$index=c}},set:function(a){try{var b=this.$events,c=b.$index;b.$index=[],this.$host.set(this.$index,a)}finally{b.$index=c}}};var c={$last:1,$first:1,$index:1},d=l(b,c);return d.$id=Kb("$proxy$each"),d}function mb(a,b){for(var c,d=b.param||"el",e=0,f=qd.length;f>e;e++){var g=qd[e];g&&g.hasOwnProperty(d)&&(c=g,qd.splice(e,1))}c||(c=lb(d));var h=b.$repeat,i=h.length-1;return c.$index=a,c.$first=0===a,c.$last=a===i,c.$host=h,c.$outer=b.$outer,c.$remove=function(){return h.removeAt(c.$index)},c}function nb(a,b){for(var c in a.$events){var d=a.$events[c];Array.isArray(d)&&(d.forEach(function(a){"object"==typeof a&&D(a)}),d.length=0)}a.$host=a.$outer={},b.unshift(a)>j.maxRepeatSize&&b.pop()}function ob(a,b){var c="_"+a;if(!ob[c]){var d=rb.createElement(a);Gb.appendChild(d),b=Fb?getComputedStyle(d,null).display:d.currentStyle.display,Gb.removeChild(d),ob[c]=b}return ob[c]}function pb(a,b,c,d){a=(a+"").replace(/[^0-9+\-Ee.]/g,"");var e=isFinite(+a)?+a:0,f=isFinite(+b)?Math.abs(b):3,g=d||",",h=c||".",i="",j=function(a,b){var c=Math.pow(10,b);return""+(Math.round(a*c)/c).toFixed(b)};return i=(f?j(e,f):""+Math.round(e)).split("."),i[0].length>3&&(i[0]=i[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,g)),(i[1]||"").length<f&&(i[1]=i[1]||"",i[1]+=new Array(f-i[1].length+1).join("0")),i.join(h)}var qb=Date.now(),rb=a.document,sb=rb.head;sb.insertAdjacentHTML("afterBegin",'<avalon ms-skip class="avalonHide"><style id="avalonStyle">.avalonHide{ display: none!important }</style></avalon>');var tb=sb.firstChild,ub="$"+qb,vb=!1,wb=/[^, ]+/g,xb=/^(?:object|array)$/,yb=/^\[object SVG\w*Element\]$/,zb=/^\[object (?:Window|DOMWindow|global)\]$/,Ab=Object.prototype,Bb=Ab.hasOwnProperty,Cb=Ab.toString,Db=Array.prototype,Eb=Db.slice,Fb=a.dispatchEvent,Gb=rb.documentElement,Hb=rb.createDocumentFragment(),Ib=rb.createElement("div"),Jb={};"Boolean Number String Function Array Date RegExp Object Error".replace(wb,function(a){Jb["[object "+a+"]"]=a.toLowerCase()});var Kb=function(a){return a=a||"avalon",String(Math.random()+Math.random()).replace(/\d\.\d{4}/,a)},Lb=g();avalon=function(a){return new avalon.init(a)},avalon.profile=function(){a.console&&avalon.config.profile&&Function.apply.call(console.log,console,arguments)},avalon.nextTick=new function(){function b(){for(var a=e.length,b=0;a>b;b++)e[b]();e=e.slice(a)}var c=a.setImmediate,d=a.MutationObserver;if(c)return c.bind(a);var e=[];if(d){var f=document.createTextNode("avalon");return new d(b).observe(f,{characterData:!0}),function(a){e.push(a),f.data=Math.random()}}return a.VBArray?function(a){e.push(a);var c=rb.createElement("script");c.onreadystatechange=function(){b(),c.onreadystatechange=null,sb.removeChild(c),c=null},sb.appendChild(c)}:function(a){setTimeout(a,4)}},avalon.init=function(a){this[0]=this.element=a},avalon.fn=avalon.prototype=avalon.init.prototype,avalon.type=function(a){return null==a?String(a):"object"==typeof a||"function"==typeof a?Jb[Cb.call(a)]||"object":typeof a};var Mb=function(a){return"[object Function]"===Cb.call(a)};avalon.isFunction=Mb,avalon.isWindow=function(a){return zb.test(Cb.call(a))},avalon.isPlainObject=function(a){return"[object Object]"===Cb.call(a)&&Object.getPrototypeOf(a)===Ab},avalon.mix=avalon.fn.mix=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[1]||{},h++),"object"==typeof g||Mb(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(avalon.isPlainObject(d)||(e=Array.isArray(d)))?(e?(e=!1,f=c&&Array.isArray(c)?c:[]):f=c&&avalon.isPlainObject(c)?c:{},g[b]=avalon.mix(j,f,d)):void 0!==d&&(g[b]=d));return g},avalon.mix({rword:wb,subscribers:ub,version:1.471,ui:{},log:c,slice:function(a,b,c){return Eb.call(a,b,c)},noop:e,error:function(a,b){throw new(b||Error)(a)},oneObject:f,range:function(a,b,c){c||(c=1),null==b&&(b=a||0,a=0);for(var d=-1,e=Math.max(0,Math.ceil((b-a)/c)),f=new Array(e);++d<e;)f[d]=a,a+=c;return f},eventHooks:{},bind:function(a,b,c,d){var e=avalon.eventHooks,f=e[b];return"object"==typeof f&&(b=f.type||b,d=f.phase||!!d,c=f.fn?f.fn(a,c):c),a.addEventListener(b,c,d),c},unbind:function(a,b,c,d){var f=avalon.eventHooks,g=f[b],h=c||e;"object"==typeof g&&(b=g.type||b,d=g.phase||!!d),a.removeEventListener(b,h,d)},css:function(a,b,c){a instanceof avalon&&(a=a[0]);var d,e=/[_-]/.test(b)?G(b):b;if(b=avalon.cssName(e)||e,void 0===c||"boolean"==typeof c){d=tc[e+":get"]||tc["@:get"],"background"===b&&(b="backgroundColor");var f=d(a,b);return c===!0?parseFloat(f)||0:f}if(""===c)a.style[b]="";else{if(null==c||c!==c)return;isFinite(c)&&!avalon.cssNumber[e]&&(c+="px"),d=tc[e+":set"]||tc["@:set"],d(a,b,c)}},each:function(a,b){if(a){var c=0;if(h(a))for(var d=a.length;d>c&&b(c,a[c])!==!1;c++);else for(c in a)if(a.hasOwnProperty(c)&&b(c,a[c])===!1)break}},getWidgetData:function(a,b){var c=avalon(a).data(),d={};for(var e in c)0===e.indexOf(b)&&(d[e.replace(b,"").replace(/\w/,function(a){return a.toLowerCase()})]=c[e]);return d},Array:{ensure:function(a,b){return-1===a.indexOf(b)?a.push(b):void 0},removeAt:function(a,b){return!!a.splice(b,1).length},remove:function(a,b){var c=a.indexOf(b);return~c?avalon.Array.removeAt(a,c):!1}}});var Nb=avalon.bindingHandlers={},Ob=avalon.bindingExecutors={},Pb=new function(){function a(a){this.size=0,this.limit=a,this.head=this.tail=void 0,this._keymap={}}var b=a.prototype;return b.put=function(a,b){var c={key:a,value:b};return this._keymap[a]=c,this.tail?(this.tail.newer=c,c.older=this.tail):this.head=c,this.tail=c,this.size===this.limit?this.shift():this.size++,b},b.shift=function(){var a=this.head;a&&(this.head=this.head.newer,this.head.older=a.newer=a.older=this._keymap[a.key]=void 0,delete this._keymap[a.key])},b.get=function(a){var b=this._keymap[a];if(void 0!==b)return b===this.tail?b.value:(b.newer&&(b===this.head&&(this.head=b.newer),b.newer.older=b.older),b.older&&(b.older.newer=b.newer),b.newer=void 0,b.older=this.tail,this.tail&&(this.tail.newer=b),this.tail=b,b.value)},a};if(rb.contains||(Node.prototype.contains=function(a){return!!(16&this.compareDocumentPosition(a))}),avalon.contains=function(a,b){try{for(;b=b.parentNode;)if(b===a)return!0;return!1}catch(c){return!1}},a.SVGElement){var Qb="http://www.w3.org/2000/svg",Rb=rb.createElementNS(Qb,"svg");Rb.innerHTML='<circle cx="50" cy="50" r="40" fill="red" />',yb.test(Rb.firstChild)||Object.defineProperties(SVGElement.prototype,{outerHTML:{enumerable:!0,configurable:!0,get:function(){return(new XMLSerializer).serializeToString(this)},set:function(a){var b=this.tagName.toLowerCase(),c=this.parentNode,d=avalon.parseHTML(a);if("svg"===b)c.insertBefore(d,this);else{var e=rb.createDocumentFragment();i(d,e),c.insertBefore(e,this)}c.removeChild(this)}},innerHTML:{enumerable:!0,configurable:!0,get:function(){var a=this.outerHTML,b=new RegExp("<"+this.nodeName+'\\b(?:(["\'])[^"]*?(\\1)|[^>])*>',"i"),c=new RegExp("</"+this.nodeName+">$","i");return a.replace(b,"").replace(c,"")},set:function(a){if(avalon.clearHTML){avalon.clearHTML(this);var b=avalon.parseHTML(a);i(b,this)}}}})}var Sb=avalon.eventHooks;"onmouseenter"in Gb||avalon.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){Sb[a]={type:b,deel:function(b,c,d){return function(c){var e=c.relatedTarget;return e&&(e===b||16&b.compareDocumentPosition(e))?void 0:(delete c.type,c.type=a,d.call(b,c))}}}}),avalon.each({AnimationEvent:"animationend",WebKitAnimationEvent:"webkitAnimationEnd"},function(b,c){a[b]&&!Sb.animationend&&(Sb.animationend={type:c})}),void 0===rb.onmousewheel&&(Sb.mousewheel={type:"wheel",fn:function(a,b){return function(c){c.wheelDeltaY=c.wheelDelta=c.deltaY>0?-120:120,c.wheelDeltaX=0,Object.defineProperty(c,"type",{value:"mousewheel"}),b.call(a,c)}}});var Tb,Ub,Vb,Wb,Xb,Yb=/[-.*+?^${}()|[\]\/\\]/g,Zb={interpolate:function(a){if(Tb=a[0],Ub=a[1],Tb===Ub)throw new SyntaxError("openTag===closeTag");var b=Tb+"test"+Ub;if(Ib.innerHTML=b,Ib.innerHTML!==b&&Ib.innerHTML.indexOf("&lt;")>-1)throw new SyntaxError("此定界符不合法");j.openTag=Tb,j.closeTag=Ub,Ib.innerHTML="";var c=k(Tb),d=k(Ub);Vb=new RegExp(c+"(.*?)"+d),Wb=new RegExp(c+"(.*?)"+d,"g"),Xb=new RegExp(c+".*?"+d+"|\\sms-")}};j.debug=!0,j.plugins=Zb,j.plugins.interpolate(["{{","}}"]),j.paths={},j.shim={},j.maxRepeatSize=100,avalon.config=j;var $b=function(a){return rb.querySelectorAll(a)},_b={$watch:function(a,b){if("function"==typeof b){var c=this.$events[a];c?c.push(b):this.$events[a]=[b]}else this.$events=this.$watch.backup;return this},$unwatch:function(a,b){var c=arguments.length;if(0===c)this.$watch.backup=this.$events,this.$events={};else if(1===c)this.$events[a]=[];else for(var d=this.$events[a]||[],e=d.length;~--e<0;)if(d[e]===b)return d.splice(e,1);return this},$fire:function(a){var b,c,d,e;/^(\w+)!(\S+)$/.test(a)&&(b=RegExp.$1,a=RegExp.$2);var f=this.$events;if(f){var g=Eb.call(arguments,1),h=[a].concat(g);if("all"===b)for(c in avalon.vmodels)d=avalon.vmodels[c],d!==this&&d.$fire.apply(d,h);else if("up"===b||"down"===b){var i=f.expr?$b(f.expr):[];if(0===i.length)return;for(c in avalon.vmodels)if(d=avalon.vmodels[c],d!==this&&d.$events.expr){var j=$b(d.$events.expr);if(0===j.length)continue;Db.forEach.call(j,function(a){Db.forEach.call(i,function(c){var e="down"===b?c.contains(a):a.contains(c);e&&(a._avalon=d)})})}var k=rb.getElementsByTagName("*"),l=[];for(Db.forEach.call(k,function(a){a._avalon&&(l.push(a._avalon),a._avalon="",a.removeAttribute("_avalon"))}),"up"===b&&l.reverse(),c=0;(e=l[c++])&&e.$fire.apply(e,h)!==!1;);}else{var m=f[a]||[],n=f.$all||[];for(c=0;e=m[c++];)Mb(e)&&e.apply(this,g);for(c=0;e=n[c++];)Mb(e)&&e.apply(this,arguments)}}}},ac=avalon.vmodels={};avalon.define=function(a,b){var d=a.$id||a;if(d||c("warning: vm必须指定$id"),ac[d]&&c("warning: "+d+" 已经存在于avalon.vmodels中"),"object"==typeof a)var f=l(a);else{var g={$watch:e};b(g),f=l(g),vb=!0,b(f),vb=!1}return f.$id=d,ac[d]=f};var bc=String("$id,$watch,$unwatch,$fire,$events,$model,$skipArray,$reinitialize").match(wb),cc=Object.is||function(a,b){return 0===a&&0===b?1/a===1/b:a!==a?b!==b:a===b},dc=function(a){var b={};for(var c in a)b[c]={get:a[c],set:a[c],enumerable:!0,configurable:!0};return b},ec=Db.splice,fc={_splice:ec,_fire:function(a,b,c){z(this.$events[ub],a,b,c)},size:function(){return this._.length},pushArray:function(a){var b=a.length,c=this.length;return b&&(Db.push.apply(this.$model,a),w.call(this,"add",c,b,Math.max(0,c-1))),b+c},push:function(){var a,b=[],c=arguments.length;for(a=0;c>a;a++)b[a]=arguments[a];return this.pushArray(b)},unshift:function(){var a=arguments.length,b=this.length;return a&&(Db.unshift.apply(this.$model,arguments),w.call(this,"add",0,a,0)),a+b},shift:function(){if(this.length){var a=this.$model.shift();return w.call(this,"del",0,1,0),a}},pop:function(){var a=this.length;if(a){var b=this.$model.pop();return w.call(this,"del",a-1,1,Math.max(0,a-2)),b}},splice:function(a){var b,c=arguments.length,d=[],e=ec.apply(this.$model,arguments);return e.length&&(d.push("del",a,e.length,0),b=!0),c>2&&(b?d.splice(3,1,0,"add",a,c-2):d.push("add",a,c-2,0),b=!0),b?w.apply(this,d):[]},contains:function(a){return-1!==this.indexOf(a)},remove:function(a){return this.removeAt(this.indexOf(a))},removeAt:function(a){return a>=0?(this.$model.splice(a,1),w.call(this,"del",a,1,0)):[]},clear:function(){return this.$model.length=this.length=this._.length=0,this._fire("clear",0),this},removeAll:function(a){if(Array.isArray(a))for(var b=this.length-1;b>=0;b--)-1!==a.indexOf(this[b])&&this.removeAt(b);else if("function"==typeof a)for(b=this.length-1;b>=0;b--){var c=this[b];a(c,b)&&this.removeAt(b)}else this.clear()},ensure:function(a){return this.contains(a)||this.push(a),this},set:function(a,b){if(a<this.length&&a>-1){var c=avalon.type(b);b&&b.$model&&(b=b.$model);var d=this[a];if("object"===c)for(var e in b)d.hasOwnProperty(e)&&(d[e]=b[e]);else"array"===c?d.clear().push.apply(d,b):d!==b&&(this[a]=b,this.$model[a]=b,this._fire("set",a,b))}return this}};"sort,reverse".replace(wb,function(a){fc[a]=function(){var b,c=this.$model,d=c.concat(),e=Math.random(),f=[];Db[a].apply(c,arguments);for(var g=0,h=d.length;h>g;g++){var i=c[g],j=d[g];if(cc(i,j))f.push(g);else{var k=d.indexOf(i);f.push(k),d[k]=e,b=!0}}return b&&(x(this,f),this._fire("move",f),this._fire("index",0)),this}});var gc=function(){var a,b=[];return{begin:function(c){b.push(a),a=c},end:function(){a=b.pop()},collectDependency:function(b,c){a&&a.callback(b,c)}}}(),hc=/^(duplex|on)$/;avalon.injectBinding=function(a){var b=a.evaluator;if(b){gc.begin({callback:function(b,c){y(b.$events[c._name],a)}});try{var d=hc.test(a.type)?a:b.apply(0,a.args);void 0===d&&delete a.evaluator,a.handler&&a.handler(d,a.element,a)}catch(e){c("warning:exception throwed in [avalon.injectBinding] ",e),delete a.evaluator;var f=a.element;if(f&&3===f.nodeType){var g=f.parentNode;j.commentInterpolate?g.replaceChild(rb.createComment(a.value),f):f.data=Tb+(a.oneTime?"::":"")+a.value+Ub}}finally{gc.end()}}};var ic=0,jc=avalon.$$subscribers=[],kc=new Date,lc={},mc=new function(){avalon.mix(this,{option:rb.createElement("select"),thead:rb.createElement("table"),td:rb.createElement("tr"),area:rb.createElement("map"),tr:rb.createElement("tbody"),col:rb.createElement("colgroup"),legend:rb.createElement("fieldset"),_default:rb.createElement("div"),g:rb.createElementNS("http://www.w3.org/2000/svg","svg")}),this.optgroup=this.option,this.tbody=this.tfoot=this.colgroup=this.caption=this.thead,this.th=this.td};String("circle,defs,ellipse,image,line,path,polygon,polyline,rect,symbol,text,use").replace(wb,function(a){mc[a]=mc.g});var nc=/<([\w:]+)/,oc=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,pc=f(["","text/javascript","text/ecmascript","application/ecmascript","application/javascript"]),qc=rb.createElement("script"),rc=/<|&#?\w+;/;avalon.parseHTML=function(a){var b=Hb.cloneNode(!1);if("string"!=typeof a)return b;if(!rc.test(a))return b.appendChild(rb.createTextNode(a)),b;a=a.replace(oc,"<$1></$2>").trim();var c,d=(nc.exec(a)||["",""])[1].toLowerCase(),e=mc[d]||mc._default;e.innerHTML=a;var f=e.getElementsByTagName("script");if(f.length)for(var g,h=0;g=f[h++];)if(pc[g.type]){var i=qc.cloneNode(!1);Db.forEach.call(g.attributes,function(a){i.setAttribute(a.name,a.value)}),i.text=g.text,g.parentNode.replaceChild(i,g)}for(;c=e.firstChild;)b.appendChild(c);return b},avalon.innerHTML=function(a,b){var c=this.parseHTML(b);this.clearHTML(a).appendChild(c)},avalon.clearHTML=function(a){for(a.textContent="";a.firstChild;)a.removeChild(a.firstChild);return a},"add,remove".replace(wb,function(a){avalon.fn[a+"Class"]=function(b){var c=this[0];return b&&"string"==typeof b&&c&&1===c.nodeType&&b.replace(/\S+/g,function(b){c.classList[a](b)}),this}}),avalon.fn.mix({hasClass:function(a){var b=this[0]||{};return 1===b.nodeType&&b.classList.contains(a)},toggleClass:function(a,b){for(var c,d=0,e=String(a).split(/\s+/),f="boolean"==typeof b;c=e[d++];){var g=f?b:!this.hasClass(c);this[g?"addClass":"removeClass"](c)}return this},attr:function(a,b){return 2===arguments.length?(this[0].setAttribute(a,b),this):this[0].getAttribute(a)},data:function(a,b){switch(a="data-"+F(a||""),arguments.length){case 2:return this.attr(a,b),this;case 1:var c=this.attr(a);return H(c);case 0:var d={};return Db.forEach.call(this[0].attributes,function(b){b&&(a=b.name,a.indexOf("data-")||(a=G(a.slice(5)),d[a]=H(b.value)))}),d}},removeData:function(a){return a="data-"+F(a),this[0].removeAttribute(a),this},css:function(a,b){if(avalon.isPlainObject(a))for(var c in a)avalon.css(this,c,a[c]);else var d=avalon.css(this,a,b);return void 0!==d?d:this},position:function(){var a,b,c=this[0],d={top:0,left:0};if(c)return"fixed"===this.css("position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),"HTML"!==a[0].tagName&&(d=a.offset()),d.top+=avalon.css(a[0],"borderTopWidth",!0),d.left+=avalon.css(a[0],"borderLeftWidth",!0),d.top-=a.scrollTop(),d.left-=a.scrollLeft()),{top:b.top-d.top-avalon.css(c,"marginTop",!0),left:b.left-d.left-avalon.css(c,"marginLeft",!0)}},offsetParent:function(){for(var a=this[0].offsetParent;a&&"static"===avalon.css(a,"position");)a=a.offsetParent;return avalon(a||Gb)},bind:function(a,b,c){return this[0]?avalon.bind(this[0],a,b,c):void 0},unbind:function(a,b,c){return this[0]&&avalon.unbind(this[0],a,b,c),this},val:function(a){var b=this[0];if(b&&1===b.nodeType){var c=0===arguments.length,d=c?":get":":set",e=yc[K(b)+d];if(e)var f=e(b,a);else{if(c)return(b.value||"").replace(/\r/g,"");b.value=a}}return c?f:this}}),Gb.dataset&&(avalon.fn.data=function(a,b){a=a&&G(a);var c=this[0].dataset;switch(arguments.length){case 2:return c[a]=b,this;case 1:return b=c[a],H(b);case 0:var e=d();for(a in c)e[a]=H(c[a]);return e}});var sc=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/;avalon.parseJSON=JSON.parse,avalon.fireDom=function(a,b,c){var d=rb.createEvent("Events");d.initEvent(b,!0,!0),avalon.mix(d,c),a.dispatchEvent(d)},avalon.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){avalon.fn[a]=function(c){var d=this[0]||{},e=I(d),f="scrollTop"===a;return arguments.length?void(e?e.scrollTo(f?e[b]:c,f?c:e[b]):d[a]=c):e?e[b]:d[a]}});var tc=avalon.cssHooks=d(),uc=["","-webkit-","-moz-","-ms-"],vc={"float":"cssFloat"};avalon.cssNumber=f("animationIterationCount,columnCount,order,flex,flexGrow,flexShrink,fillOpacity,fontWeight,lineHeight,opacity,orphans,widows,zIndex,zoom"),avalon.cssName=function(a,b,c){if(vc[a])return vc[a];b=b||Gb.style;for(var d=0,e=uc.length;e>d;d++)if(c=G(uc[d]+a),c in b)return vc[a]=c;
return null},tc["@:set"]=function(a,b,c){a.style[b]=c},tc["@:get"]=function(a,b){if(!a||!a.style)throw new Error("getComputedStyle要求传入一个节点 "+a);var c,d=getComputedStyle(a);return d&&(c="filter"===b?d.getPropertyValue(b):d[b],""===c&&(c=a.style[b])),c},tc["opacity:get"]=function(a){var b=tc["@:get"](a,"opacity");return""===b?"1":b},"top,left".replace(wb,function(a){tc[a+":get"]=function(b){var c=tc["@:get"](b,a);return/px$/.test(c)?c:avalon(b).position()[a]+"px"}});var wc={position:"absolute",visibility:"hidden",display:"block"},xc=/^(none|table(?!-c[ea]).+)/;"Width,Height".replace(wb,function(a){var b=a.toLowerCase(),c="client"+a,d="scroll"+a,e="offset"+a;tc[b+":get"]=function(b,c,d){var f=-4;"number"==typeof d&&(f=d),c="Width"===a?["Left","Right"]:["Top","Bottom"];var g=b[e];return 2===f?g+avalon.css(b,"margin"+c[0],!0)+avalon.css(b,"margin"+c[1],!0):(0>f&&(g=g-avalon.css(b,"border"+c[0]+"Width",!0)-avalon.css(b,"border"+c[1]+"Width",!0)),-4===f&&(g=g-avalon.css(b,"padding"+c[0],!0)-avalon.css(b,"padding"+c[1],!0)),g)},tc[b+"&get"]=function(a){var c=[];J(a,c);for(var d,e=tc[b+":get"](a),f=0;d=c[f++];){a=d.node;for(var g in d)"string"==typeof d[g]&&(a.style[g]=d[g])}return e},avalon.fn[b]=function(f){var g=this[0];if(0===arguments.length){if(g.setTimeout)return g["inner"+a];if(9===g.nodeType){var h=g.documentElement;return Math.max(g.body[d],h[d],g.body[e],h[e],h[c])}return tc[b+"&get"](g)}return this.css(b,f)},avalon.fn["inner"+a]=function(){return tc[b+":get"](this[0],void 0,-2)},avalon.fn["outer"+a]=function(a){return tc[b+":get"](this[0],void 0,a===!0?2:0)}}),avalon.fn.offset=function(){var a=this[0];try{var b=a.getBoundingClientRect();if(b.width||b.height||a.getClientRects().length){var c=a.ownerDocument,d=c.documentElement,e=c.defaultView;return{top:b.top+e.pageYOffset-d.clientTop,left:b.left+e.pageXOffset-d.clientLeft}}}catch(f){return{left:0,top:0}}};var yc={"select:get":function(a,b){for(var c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],(c.selected||i===e)&&!c.disabled){if(b=c.value,f)return b;g.push(b)}return g},"select:set":function(a,b,c){b=[].concat(b);for(var d,e=0;d=a.options[e++];)(d.selected=b.indexOf(d.value)>-1)&&(c=!0);c||(a.selectedIndex=-1)}},zc=JSON.stringify,Ac=["break,case,catch,continue,debugger,default,delete,do,else,false","finally,for,function,if,in,instanceof,new,null,return,switch,this","throw,true,try,typeof,var,void,while,with","abstract,boolean,byte,char,class,const,double,enum,export,extends","final,float,goto,implements,import,int,interface,long,native","package,private,protected,public,short,static,super,synchronized","throws,transient,volatile","arguments,let,yield,undefined"].join(","),Bc=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|[\s\t\n]*\.[\s\t\n]*[$\w\.]+/g,Cc=/[^\w$]+/g,Dc=new RegExp(["\\b"+Ac.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),Ec=/\b\d[^,]*/g,Fc=/^,+|,+$/g,Gc=new Pb(512),Hc=function(a){var b=","+a.trim(),c=Gc.get(b);if(c)return c;var d=a.replace(Bc,"").replace(Cc,",").replace(Dc,"").replace(Ec,"").replace(Fc,"").split(/^$|,+/);return Gc.put(b,M(d))},Ic=new Pb(128),Jc=/\w\[.*\]|\w\.\w/,Kc=/(\$proxy\$[a-z]+)\d+$/,Lc=/\)\s*$/,Mc=/\)\s*\|/g,Nc=/\|\s*([$\w]+)/g,Oc=/"\s*\["/g,Pc=/"\s*\(/g;avalon.parseExprProxy=Q,avalon.scan=function(a,b){a=a||Gb;var c=b?[].concat(b):[];Y(a,c)};var Qc=f("area,base,basefont,br,col,command,embed,hr,img,input,link,meta,param,source,track,wbr,noscript,script,style,textarea".toUpperCase()),Rc=function(a,b,c){var d=a.getAttribute(b);if(d)for(var e,f=0;e=c[f++];)if(e.hasOwnProperty(d)&&"function"==typeof e[d])return e[d]},Sc=Lb&&a.MutationObserver?function(a){for(var b,c=a.firstChild;c;){var d=c.nextSibling;3===c.nodeType?b?(b.nodeValue+=c.nodeValue,a.removeChild(c)):b=c:b=null,c=d}}:0,Tc=/^\s*::/,Uc=/ms-(\w+)-?(.*)/,Vc={"if":10,repeat:90,data:100,widget:110,each:1400,"with":1500,duplex:2e3,on:3e3},Wc=f("animationend,blur,change,input,click,dblclick,focus,keydown,keypress,keyup,mousedown,mouseenter,mouseleave,mousemove,mouseout,mouseover,mouseup,scan,scroll,submit"),Xc=f("value,title,alt,checked,selected,disabled,readonly,enabled"),Yc=/^if|widget|repeat$/,Zc=/^each|with|html|include$/,$c=/\|\s*html(?:\b|$)/,_c=/\|\|/g,ad=/(['"])(\\\1|.)+?\1/g,bd=["autofocus,autoplay,async,allowTransparency,checked,controls","declare,disabled,defer,defaultChecked,defaultSelected","contentEditable,isMap,loop,multiple,noHref,noResize,noShade","open,readOnly,selected"].join(","),cd={};bd.replace(wb,function(a){cd[a.toLowerCase()]=a});var dd={"accept-charset":"acceptCharset","char":"ch",charoff:"chOff","class":"className","for":"htmlFor","http-equiv":"httpEquiv"},ed=["accessKey,bgColor,cellPadding,cellSpacing,codeBase,codeType,colSpan","dateTime,defaultValue,frameBorder,longDesc,maxLength,marginWidth,marginHeight","rowSpan,tabIndex,useMap,vSpace,valueType,vAlign"].join(",");ed.replace(wb,function(a){dd[a.toLowerCase()]=a});var fd=/<noscript.*?>(?:[\s\S]+?)<\/noscript>/gim,gd=/<noscript.*?>([\s\S]+?)<\/noscript>/im,hd=function(){return new(a.XMLHttpRequest||ActiveXObject)("Microsoft.XMLHTTP")},id=avalon.templateCache={};Nb.attr=function(a,b){var c=P(a.value.trim());if("include"===a.type){var d=a.element;a.includeRendered=Rc(d,"data-include-rendered",b),a.includeLoaded=Rc(d,"data-include-loaded",b);var e=a.includeReplace=!!avalon(d).data("includeReplace");avalon(d).data("includeCache")&&(a.templateCache={}),a.startInclude=rb.createComment("ms-include"),a.endInclude=rb.createComment("ms-include-end"),e?(a.element=a.startInclude,d.parentNode.insertBefore(a.startInclude,d),d.parentNode.insertBefore(a.endInclude,d.nextSibling)):(d.insertBefore(a.startInclude,d.firstChild),d.appendChild(a.endInclude))}a.handlerName="attr",Q(c,b,a)},Ob.attr=function(b,c,d){var e=d.type,f=d.param;if("css"===e)avalon(c).css(f,b);else if("attr"===e){var g=b===!1||null===b||void 0===b;!Fb&&dd[f]&&(f=dd[f]);var h=cd[f];if("boolean"==typeof c[h]&&(c[h]=!!b,b||(g=!0)),g)return c.removeAttribute(f);var i=yb.test(c)?!1:rb.namespaces&&isVML(c)?!0:f in c.cloneNode(!1);i?c[f]=b+"":c.setAttribute(f,b)}else if("include"===e&&b){var j=d.vmodels,k=d.includeRendered,l=d.includeLoaded,m=d.includeReplace,n=m?c.parentNode:c,o=function(a){if(null!==d.vmodels){if(l){var c=l.apply(n,[a].concat(j));"string"==typeof c&&(a=c)}k&&R(n,function(){k.call(n)},0/0);var e=d.includeLastID;if(d.templateCache&&e&&e!==b){var f=d.templateCache[e];f||(f=d.templateCache[e]=rb.createElement("div"),tb.appendChild(f))}for(d.includeLastID=b;d.startInclude;){var g=d.startInclude.nextSibling;if(!g||g===d.endInclude)break;n.removeChild(g),f&&f.appendChild(g)}var h=ab(d,b,a),i=avalon.slice(h.childNodes);n.insertBefore(h,d.endInclude),X(i,j)}};if("src"===d.param)if("string"==typeof id[b])avalon.nextTick(function(){o(id[b])});else if(Array.isArray(id[b]))id[b].push(o);else{var p=hd();p.onreadystatechange=function(){if(4===p.readyState){var a=p.status;if(a>=200&&300>a||304===a||1223===a){for(var c,d=p.responseText,e=0;c=id[b][e++];)c(d);id[b]=d}}},id[b]=[o],p.open("GET",b,!0),"withCredentials"in p&&(p.withCredentials=!0),p.setRequestHeader("X-Requested-With","XMLHttpRequest"),p.send(null)}else{var q=b&&1===b.nodeType?b:rb.getElementById(b);if(q){if("NOSCRIPT"===q.tagName&&!q.innerHTML&&!q.fixIE78){p=hd(),p.open("GET",location,!1),p.send(null);for(var r=rb.getElementsByTagName("noscript"),s=(p.responseText||"").match(fd)||[],t=s.length,u=0;t>u;u++){var v=r[u];v&&(v.style.display="none",v.fixIE78=(s[u].match(gd)||["","&nbsp;"])[1])}}avalon.nextTick(function(){o(q.fixIE78||q.value||q.innerText||q.innerHTML)})}}}else if(Gb.hasAttribute||"string"!=typeof b||"src"!==e&&"href"!==e||(b=b.replace(/&amp;/g,"&")),c[e]=b,a.chrome&&"EMBED"===c.tagName){var w=c.parentNode,x=document.createComment("ms-src");w.replaceChild(x,c),w.replaceChild(c,x)}},"title,alt,src,value,css,include,href".replace(wb,function(a){Nb[a]=Nb.attr}),Nb["class"]=function(a,b){var c,d=a.param,e=a.value;if(a.handlerName="class",!d||isFinite(d)){a.param="";var f=e.replace(Wb,function(a){return a.replace(/./g,"0")}).indexOf(":");if(-1===f){var g=e;c=!0}else g=e.slice(0,f),c=e.slice(f+1);g=Vb.test(e)?P(g):zc(g),a.expr="["+g+","+c+"]"}else a.expr="["+zc(d)+","+e+"]",a.oldStyle=d;var h=a.type;if("hover"===h||"active"===h){if(!a.hasBindEvent){var i=a.element,j=avalon(i),k="mouseenter",l="mouseleave";if("active"===h){i.tabIndex=i.tabIndex||-1,k="mousedown",l="mouseup";var m=j.bind("mouseleave",function(){a.toggleClass&&j.removeClass(a.newClass)})}}var n=j.bind(k,function(){a.toggleClass&&j.addClass(a.newClass)}),o=j.bind(l,function(){a.toggleClass&&j.removeClass(a.newClass)});a.rollback=function(){j.unbind("mouseleave",m),j.unbind(k,n),j.unbind(l,o)},a.hasBindEvent=!0}Q(a.expr,b,a)},Ob["class"]=function(a,b,c){var d=avalon(b);c.newClass=a[0],c.toggleClass=!!a[1],c.oldClass&&c.newClass!==c.oldClass&&d.removeClass(c.oldClass),c.oldClass=c.newClass,"class"===c.type&&(c.oldStyle?d.toggleClass(c.oldStyle,!!a[1]):d.toggleClass(c.newClass,c.toggleClass))},"hover,active".replace(wb,function(a){Nb[a]=Nb["class"]}),Ob.data=function(a,b,c){var d="data-"+c.param;a&&"object"==typeof a?b[d]=a:b.setAttribute(d,String(a))};var jd=Nb.duplex=function(a,b){var d,g=a.element;if(Q(a.value,b,a,1),a.changed=Rc(g,"data-duplex-changed",b)||e,a.evaluator&&a.args){var h=[],i=f("string,number,boolean,checked");"radio"===g.type&&""===a.param&&(a.param="checked"),g.msData&&(g.msData["ms-duplex"]=a.value),a.param.replace(/\w+/g,function(b){/^(checkbox|radio)$/.test(g.type)&&/^(radio|checked)$/.test(b)&&("radio"===b&&c("ms-duplex-radio已经更名为ms-duplex-checked"),b="checked",a.isChecked=!0),"bool"===b?(b="boolean",c("ms-duplex-bool已经更名为ms-duplex-boolean")):"text"===b&&(b="string",c("ms-duplex-text已经更名为ms-duplex-string")),i[b]&&(d=!0),avalon.Array.ensure(h,b)}),d||h.push("string"),a.param=h.join("-"),a.bound=function(b,c){g.addEventListener?g.addEventListener(b,c,!1):g.attachEvent("on"+b,c);var d=a.rollback;a.rollback=function(){g.avalonSetter=null,avalon.unbind(g,b,c),d&&d()}};for(var j in avalon.vmodels){var k=avalon.vmodels[j];k.$fire("avalon-ms-duplex-init",a)}var l=a.pipe||(a.pipe=cb);l(null,a,"init");var m=g.tagName;jd[m]&&jd[m](g,a.evaluator.apply(null,a.args),a)}};avalon.duplexHooks={checked:{get:function(a,b){return!b.element.oldValue}},string:{get:function(a){return a},set:bb},"boolean":{get:function(a){return"true"===a},set:bb},number:{get:function(a,b){var c=parseFloat(a);if(-a===-c)return c;var d=/strong|medium|weak/.exec(b.element.getAttribute("data-duplex-number"))||["medium"];switch(d[0]){case"strong":return 0;case"medium":return""===a?"":0;case"weak":return a}},set:bb}};var kd,ld=[];avalon.tick=function(a){1===ld.push(a)&&(kd=setInterval(db,60))};var md=e;!new function(){function a(a){b[this.tagName].call(this,a),!this.msFocus&&this.avalonSetter&&this.avalonSetter()}try{var b={},c=HTMLInputElement.prototype,d=HTMLTextAreaElement.prototype,e=HTMLInputElement.prototype;Object.getOwnPropertyNames(e),b.INPUT=Object.getOwnPropertyDescriptor(c,"value").set,Object.defineProperty(c,"value",{set:a}),b.TEXTAREA=Object.getOwnPropertyDescriptor(d,"value").set,Object.defineProperty(d,"value",{set:a})}catch(f){md=avalon.tick}};var nd=/^(file|button|reset|submit|checkbox|radio|range)$/;jd.INPUT=function(a,b,d){function e(a){d.changed.call(this,a,d)}function f(){l=!0}function g(){l=!1}var h,i=a.type,j=d.bound,k=avalon(a),l=!1,m=function(){var c=a.value;if(!l&&c!==h){var f=d.pipe(c,d,"get");k.data("duplexObserve")!==!1&&(h=c,b(f),e.call(a,f))}};if(d.handler=function(){var c=d.pipe(b(),d,"set");if(c!==h){var e=!1;if(a.msFocus)try{var f=a.selectionStart,g=a.selectionEnd;if(f===g){var i=f;e=!0}}catch(j){}a.value=h=c,e&&!a.readyOnly&&(a.selectionStart=a.selectionEnd=i)}},d.isChecked||"radio"===i)m=function(){if(k.data("duplexObserve")!==!1){var c=d.pipe(a.value,d,"get");b(c),e.call(a,c)}},d.handler=function(){var c=b(),e=d.isChecked?!!c:c+""===a.value;a.checked=a.oldValue=e},j("click",m);else if("checkbox"===i)m=function(){if(k.data("duplexObserve")!==!1){var f=a.checked?"ensure":"remove",g=b();Array.isArray(g)||(c("ms-duplex应用于checkbox上要对应一个数组"),g=[g]),avalon.Array[f](g,d.pipe(a.value,d,"get")),e.call(a,g)}},d.handler=function(){var c=[].concat(b());a.checked=c.indexOf(d.pipe(a.value,d,"get"))>-1},j("change",m);else{var n=a.getAttribute("data-duplex-event")||"input";a.attributes["data-event"]&&c("data-event指令已经废弃，请改用data-duplex-event"),n.replace(wb,function(a){switch(a){case"input":j("input",m),j("keyup",m),Lb||(j("compositionstart",f),j("compositionend",g),j("DOMAutoComplete",m));break;default:j(a,m)}}),nd.test(i)||("hidden"!==i&&(j("focus",function(){a.msFocus=!0}),j("blur",function(){a.msFocus=!1})),a.avalonSetter=m,md(function(){if(Gb.contains(a))a.msFocus||m();else if(!a.msRetain)return!1}))}avalon.injectBinding(d),e.call(a,a.value)},jd.TEXTAREA=jd.INPUT,jd.SELECT=function(a,b,d){function e(){if(f.data("duplexObserve")!==!1){var c=f.val();c=Array.isArray(c)?c.map(function(a){return d.pipe(a,d,"get")}):d.pipe(c,d,"get"),c+""!==a.oldValue&&b(c),d.changed.call(a,c,d)}}var f=avalon(a);d.handler=function(){var d=b();d=d&&d.$model||d,Array.isArray(d)?a.multiple||c("ms-duplex在<select multiple=true>上要求对应一个数组"):a.multiple&&c("ms-duplex在<select multiple=false>不能对应一个数组"),d=Array.isArray(d)?d.map(String):d+"",d+""!==a.oldValue&&(f.val(d),a.oldValue=d+"")},d.bound("change",e),a.msCallback=function(){avalon.injectBinding(d),d.changed.call(a,b(),d)}},Ob.html=function(a,b,c){var d=1!==b.nodeType,e=d?b.parentNode:b;if(e&&(a=null==a?"":a,c.oldText!==a)){if(c.oldText=a,3===b.nodeType){var f=Kb("html");e.insertBefore(rb.createComment(f),b),c.element=rb.createComment(f+":end"),e.replaceChild(c.element,b),b=c.element}if("object"!=typeof a)var g=avalon.parseHTML(String(a));else if(11===a.nodeType)g=a;else if(1===a.nodeType||a.item){var h=1===a.nodeType?a.childNodes:a.item;for(g=Hb.cloneNode(!0);h[0];)g.appendChild(h[0])}if(h=avalon.slice(g.childNodes),d){for(var i=b.nodeValue.slice(0,-4);;){var j=b.previousSibling;if(!j||8===j.nodeType&&j.nodeValue===i)break;e.removeChild(j)}e.insertBefore(g,b)}else avalon.clearHTML(b).appendChild(g);X(h,c.vmodels)}},Nb["if"]=Nb.data=Nb.text=Nb.html=function(a,b){Q(a.value,b,a)},Ob["if"]=function(a,b,c){try{if(!b.parentNode)return}catch(d){return}if(a)8===b.nodeType&&(b.parentNode.replaceChild(c.template,b),b.ifRemove=null,b=c.element=c.template),b.getAttribute(c.name)&&(b.removeAttribute(c.name),V(b,c.vmodels)),c.rollback=null;else if(1===b.nodeType){var e=c.element=rb.createComment("ms-if");b.parentNode.replaceChild(e,b),b.ifRemove=e,c.template=b,tb.appendChild(b),c.rollback=function(){b.parentNode===tb&&tb.removeChild(b)}}};var od=/\(([^)]*)\)/;Nb.on=function(a,b){var c=a.value;a.type="on";var d=a.param.replace(/-\d+$/,"");if("function"==typeof Nb.on[d+"Hook"]&&Nb.on[d+"Hook"](a),c.indexOf("(")>0&&c.indexOf(")")>-1){var e=(c.match(od)||["",""])[1].trim();(""===e||"$event"===e)&&(c=c.replace(od,""))}Q(c,b,a)},Ob.on=function(a,b,c){a=function(a){var b=c.evaluator||e;return b.apply(this,c.args.concat(a))};var d=c.param.replace(/-\d+$/,"");if("scan"===d)a.call(b,{type:d});else if("function"==typeof c.specialBind)c.specialBind(b,a);else var f=avalon.bind(b,d,a);c.rollback=function(){"function"==typeof c.specialUnbind?c.specialUnbind():avalon.unbind(b,d,f)}},Nb.repeat=function(a,b){var c=a.type;Q(a.value,b,a,1),a.proxies=[];var d=!1;try{var f=a.$repeat=a.evaluator.apply(0,a.args||[]),g=avalon.type(f);"object"!==g&&"array"!==g?(d=!0,avalon.log("warning:"+a.value+"只能是对象或数组")):a.xtype=g}catch(h){d=!0}var i=a.value.split(".")||[];if(i.length>1){i.pop();for(var j,k=i[0],l=0;j=b[l++];)if(j&&j.hasOwnProperty(k)){var m=j[k].$events||{};m[ub]=m[ub]||[],m[ub].push(a);break}}var n=a.handler;a.handler=e,avalon.injectBinding(a),a.handler=n;var o=a.element;if(1===o.nodeType){o.removeAttribute(a.name),a.sortedCallback=Rc(o,"data-with-sorted",b),a.renderedCallback=Rc(o,"data-"+c+"-rendered",b);var p=Kb(c),q=rb.createComment(p),r=rb.createComment(p+":end");if(a.signature=p,a.template=Hb.cloneNode(!1),"repeat"===c){var s=o.parentNode;s.replaceChild(r,o),s.insertBefore(q,r),a.template.appendChild(o)}else{for(;o.firstChild;)a.template.appendChild(o.firstChild);o.appendChild(q),o.appendChild(r)}a.element=r,a.handler=Ob.repeat,a.rollback=function(){var b=a.element;b&&a.handler("clear")}}if(!d){a.$outer={};var t="$key",u="$val";for(Array.isArray(f)&&(t="$first",u="$last"),l=0;j=b[l++];)if(j.hasOwnProperty(t)&&j.hasOwnProperty(u)){a.$outer=j;break}var v=f.$events,w=(v||{})[ub];y(w,a),"object"===g?a.handler("append"):f.length&&a.handler("add",0,f.length)}},Ob.repeat=function(a,b,c){var d=this;if(!a&&d.xtype){var f=d.$repeat,g=d.evaluator.apply(0,d.args||[]);if("array"===d.xtype){if(f.length===g.length){if(!(f!==g&&f.length>0))return;Ob.repeat.call(this,"clear",b,c)}a="add",b=0,d.$repeat=g,c=g.length}else{if(n(f).join(";;")===n(g).join(";;"))return;a="append",d.$repeat=g}}if(a){var h,i,j=d.element,k=fb(d),l=j.parentNode,m=d.proxies,o=Hb.cloneNode(!1);switch(a){case"add":for(var p=b+c,q=[],r=b;p>r;r++){var s=mb(r,d);m.splice(r,0,s),eb(d,o,s,q)}for(l.insertBefore(o,k[b]||j),r=0;i=q[r++];)X(i.nodes,i.vmodels),i.nodes=i.vmodels=null;break;case"del":gb(k[b],k[b+c]||j);var t=m.splice(b,c);jb(t,"each");break;case"clear":h=k[0],h&&(gb(h,j),"object"===d.xtype?l.insertBefore(h,j):jb(m,"each"));break;case"move":if(h=k[0]){var u,v=h.nodeValue,w=[],y=[];for(gb(h,j,function(){y.unshift(this),this.nodeValue===v&&(w.unshift(y),y=[])}),x(w,b),x(m,b);y=w.shift();)for(;u=y.shift();)o.appendChild(u);l.insertBefore(o,j)}break;case"index":for(var A=m.length-1;c=m[b];b++)c.$index=b,c.$first=0===b,c.$last=b===A;return;case"set":s=m[b],s&&z(s.$events[d.param||"el"]);break;case"append":var B=d.$repeat,C=Array.isArray(m)||!m?{}:m;d.proxies=C;var D=[];q=[];for(var E in C)B.hasOwnProperty(E)||(nb(C[E],pd),delete C[E]);for(E in B)B.hasOwnProperty(E)&&"hasOwnProperty"!==E&&D.push(E);if(d.sortedCallback){var F=d.sortedCallback.call(l,D);F&&Array.isArray(F)&&F.length&&(D=F)}for(r=0;E=D[r++];)"hasOwnProperty"!==E&&(C[E]=ib(C[E],E,d),eb(d,o,C[E],q));for(l.insertBefore(o,j),r=0;i=q[r++];)X(i.nodes,i.vmodels),i.nodes=i.vmodels=null}if(!d.$repeat||d.$repeat.hasOwnProperty("$lock"))return;"clear"===a&&(a="del");var G=d.renderedCallback||e,H=arguments;l.oldValue&&"SELECT"===l.tagName&&avalon(l).val(l.oldValue.split(",")),G.apply(l,H)}},"with,each".replace(wb,function(a){Nb[a]=Nb.repeat});var pd=[],qd=[];Ob.text=function(a,b){if(a=null==a?"":a,3===b.nodeType)try{b.data=a}catch(c){}else b.textContent=a},avalon.parseDisplay=ob,Nb.visible=function(a,b){Q(a.value,b,a)},Ob.visible=function(a,b,c){a?(b.style.display=c.display||"","none"===avalon(b).css("display")&&(b.style.display=c.display=ob(b.nodeName))):b.style.display="none"},Nb.widget=function(b,d){var f=b.value.match(wb),g=b.element,h=f[0],i=f[1];i&&"$"!==i||(i=Kb(h));var j=f[2]||h,k=avalon.ui[h];if("function"==typeof k){d=g.vmodels||d;for(var l,m=0;l=d[m++];)if(l.hasOwnProperty(j)&&"object"==typeof l[j]){var n=l[j];n=n.$model||n;break}if(n){var o=n[h+"Id"];"string"==typeof o&&(c("warning!不再支持"+h+"Id"),i=o)}var p=avalon.getWidgetData(g,h);b.value=[h,i,j].join(","),b[h+"Id"]=i,b.evaluator=e,g.msData["ms-widget-id"]=i;var q=b[h+"Options"]=avalon.mix({},k.defaults,n||{},p);g.removeAttribute("ms-widget");var r=k(g,b,d)||{};if(r.$id){avalon.vmodels[i]=r,S(g,r);try{r.$init(function(){avalon.scan(g,[r].concat(d)),"function"==typeof q.onInit&&q.onInit.call(g,r,q,d)})}catch(s){c(s)}b.rollback=function(){try{r.$remove(),r.widgetElement=null}catch(a){}g.msData={},delete avalon.vmodels[r.$id]},B(b,rd),a.chrome&&g.addEventListener("DOMNodeRemovedFromDocument",function(){setTimeout(C)})}else avalon.scan(g,d)}else d.length&&(g.vmodels=d)};var rd=[],sd=/<script[^>]*>([\S\s]*?)<\/script\s*>/gim,td=/\s+(on[^=\s]+)(?:=("[^"]*"|'[^']*'|[^\s>]+))?/g,ud=/<\w+\b(?:(["'])[^"]*?(\1)|[^>])*>/gi,vd={a:/\b(href)\=("javascript[^"]*"|'javascript[^']*')/gi,img:/\b(src)\=("javascript[^"]*"|'javascript[^']*')/gi,form:/\b(action)\=("javascript[^"]*"|'javascript[^']*')/gi},wd=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,xd=/([^\#-~| |!])/g,yd=avalon.filters={uppercase:function(a){return a.toUpperCase()},lowercase:function(a){return a.toLowerCase()},truncate:function(a,b,c){return b=b||30,c="string"==typeof c?c:"...",a.length>b?a.slice(0,b-c.length)+c:String(a)},$filter:function(a){for(var b=1,c=arguments.length;c>b;b++){var d=arguments[b],e=avalon.filters[d[0]];if("function"==typeof e){var f=[a].concat(d.slice(1));a=e.apply(null,f)}}return a},camelize:G,sanitize:function(a){return a.replace(sd,"").replace(ud,function(a){var b=a.toLowerCase().match(/<(\w+)\s/);if(b){var c=vd[b[1]];c&&(a=a.replace(c,function(a,b,c){var d=c.charAt(0);return b+"="+d+"javascript:void(0)"+d}))}return a.replace(td," ").replace(/\s+/g," ")})},escape:function(a){return String(a).replace(/&/g,"&amp;").replace(wd,function(a){var b=a.charCodeAt(0),c=a.charCodeAt(1);return"&#"+(1024*(b-55296)+(c-56320)+65536)+";"}).replace(xd,function(a){return"&#"+a.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")},currency:function(a,b,c){return(b||"￥")+pb(a,isFinite(c)?c:2)},number:pb};!new function(){function a(a){return parseInt(a,10)||0}function b(a,b,c){var d="";for(0>a&&(d="-",a=-a),a=""+a;a.length<b;)a="0"+a;return c&&(a=a.substr(a.length-b)),d+a}function c(a,c,d,e){return function(f){var g=f["get"+a]();return(d>0||g>-d)&&(g+=d),0===g&&-12===d&&(g=12),b(g,c,e)}}function d(a,b){return function(c,d){var e=c["get"+a](),f=(b?"SHORT"+a:a).toUpperCase();return d[f][e]}}function e(a){var c=-1*a.getTimezoneOffset(),d=c>=0?"+":"";return d+=b(Math[c>0?"floor":"ceil"](c/60),2)+b(Math.abs(c%60),2)}function f(a,b){return a.getHours()<12?b.AMPMS[0]:b.AMPMS[1]}var g={yyyy:c("FullYear",4),yy:c("FullYear",2,0,!0),y:c("FullYear",1),MMMM:d("Month"),MMM:d("Month",!0),MM:c("Month",2,1),M:c("Month",1,1),dd:c("Date",2),d:c("Date",1),HH:c("Hours",2),H:c("Hours",1),hh:c("Hours",2,-12),h:c("Hours",1,-12),mm:c("Minutes",2),m:c("Minutes",1),ss:c("Seconds",2),s:c("Seconds",1),sss:c("Milliseconds",3),EEEE:d("Day"),EEE:d("Day",!0),a:f,Z:e},h=/((?:[^yMdHhmsaZE']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z))(.*)/,i=/^\/Date\((\d+)\)\/$/;yd.date=function(b,c){var d,e,f=yd.date.locate,j="",k=[];if(c=c||"mediumDate",c=f[c]||c,"string"==typeof b)if(/^\d+$/.test(b))b=a(b);else if(i.test(b))b=+RegExp.$1;else{var l=b.trim(),m=[0,0,0,0,0,0,0],n=new Date(0);l=l.replace(/^(\d+)\D(\d+)\D(\d+)/,function(b,c,d,e){var f=4===e.length?[e,c,d]:[c,d,e];return m[0]=a(f[0]),m[1]=a(f[1])-1,m[2]=a(f[2]),""});var o=n.setFullYear,p=n.setHours;l=l.replace(/[T\s](\d+):(\d+):?(\d+)?\.?(\d)?/,function(b,c,d,e,f){return m[3]=a(c),m[4]=a(d),m[5]=a(e),f&&(m[6]=Math.round(1e3*parseFloat("0."+f))),""});var q=0,r=0;l=l.replace(/Z|([+-])(\d\d):?(\d\d)/,function(b,c,d,e){return o=n.setUTCFullYear,p=n.setUTCHours,c&&(q=a(c+d),r=a(c+e)),""}),m[3]-=q,m[4]-=r,o.apply(n,m.slice(0,3)),p.apply(n,m.slice(3)),b=n}if("number"==typeof b&&(b=new Date(b)),"date"===avalon.type(b)){for(;c;)e=h.exec(c),e?(k=k.concat(e.slice(1)),c=k.pop()):(k.push(c),c=null);return k.forEach(function(a){d=g[a],j+=d?d(b,f):a.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),j}};var j={AMPMS:{0:"上午",1:"下午"},DAY:{0:"星期日",1:"星期一",2:"星期二",3:"星期三",4:"星期四",5:"星期五",6:"星期六"},MONTH:{0:"1月",1:"2月",2:"3月",3:"4月",4:"5月",5:"6月",6:"7月",7:"8月",8:"9月",9:"10月",10:"11月",11:"12月"},SHORTDAY:{0:"周日",1:"周一",2:"周二",3:"周三",4:"周四",5:"周五",6:"周六"},fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"yyyy-M-d H:mm:ss",mediumDate:"yyyy-M-d",mediumTime:"H:mm:ss","short":"yy-M-d ah:mm",shortDate:"yy-M-d",shortTime:"ah:mm"};j.SHORTMONTH=j.MONTH,yd.date.locate=j},new function(){function a(a){for(d=1;a=c.shift();)a()}avalon.config({loader:!1});var b,c=[],d="complete"===rb.readyState;avalon.bind(rb,"DOMContentLoaded",b=function(){avalon.unbind(rb,"DOMContentLoaded",b),a()});var e=setInterval(function(){"complete"===document.readyState&&document.body&&(clearInterval(e),a())},50);avalon.ready=function(a){d?a(avalon):c.push(a)},avalon.ready(function(){avalon.scan(rb.body)})},new function(){function b(){return/iPad|iPhone|iPod/i.test(d)&&!a.MSStream?"backdropFilter"in document.documentElement.style?9:a.indexedDB?8:a.SpeechSynthesisUtterance?7:a.webkitAudioContext?6:a.matchMedia?5:a.history&&"pushState"in a.history?4:3:0/0}function c(a,b){return b&&i.forEach(function(c){a[c]=b[c]}),a}var d=navigator.userAgent.toLowerCase(),f=d.indexOf("android")>0,g=b(),h=avalon.gestureHooks={pointers:{},start:function(a,b){for(var d=0;d<a.changedTouches.length;d++){var e=a.changedTouches[d],f={startTouch:c({},e),startTime:Date.now(),status:"tapping",element:a.target};h.pointers[e.identifier]=f,b(f,e)}},move:function(a,b){for(var d=0;d<a.changedTouches.length;d++){var e=a.changedTouches[d],f=h.pointers[e.identifier];if(!f)return;"lastTouch"in f||(f.lastTouch=f.startTouch,f.lastTime=f.startTime,f.deltaX=f.deltaY=f.duration=f.distance=0);var g=Date.now()-f.lastTime;if(g>0){var i=70;g>i&&(g=i),f.duration+g>i&&(f.duration=i-g),f.duration+=g,f.lastTouch=c({},e),f.lastTime=Date.now(),f.deltaX=e.clientX-f.startTouch.clientX,f.deltaY=e.clientY-f.startTouch.clientY;var j=f.deltaX*f.deltaX,k=f.deltaY*f.deltaY;f.distance=Math.sqrt(j+k),f.isVertical=k>j,b(f,e)}}},end:function(a,b){for(var c=0;c<a.changedTouches.length;c++){var d=a.changedTouches[c],e=d.identifier,f=h.pointers[e];f&&(b(f,d),delete h.pointers[e])}},fire:function(a,b,c){if(a){var d=document.createEvent("Events");d.initEvent(b,!0,!0),avalon.mix(d,c),a.dispatchEvent(d)}},add:function(a,b){function c(a){b.touchmove(a)}function d(a){b.touchend(a),document.removeEventListener("touchmove",c),document.removeEventListener("touchend",d),document.removeEventListener("touchcancel",e)}function e(a){b.touchcancel(a),document.removeEventListener("touchmove",c),document.removeEventListener("touchend",d),document.removeEventListener("touchcancel",e)}b.events.forEach(function(f){avalon.eventHooks[f]={fn:function(f,g){return f["touch-"+a]||(f["touch-"+a]="1",f.addEventListener("touchstart",function(a){b.touchstart(a),document.addEventListener("touchmove",c),document.addEventListener("touchend",d),document.addEventListener("touchcancel",e)})),g}}})}},i=["screenX","screenY","clientX","clientY","pageX","pageY"],j=!!navigator.pointerEnabled||!!navigator.msPointerEnabled;j&&(Gb.style.msTouchAction=Gb.style.touchAction="none");var k={events:["tap"],touchBoundary:10,tapDelay:200,needClick:function(a){switch(a.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(a.disabled)return!0;break;case"input":if(g&&"file"===a.type||a.disabled)return!0;break;case"label":case"iframe":case"video":return!0}return!1},needFocus:function(a){switch(a.nodeName.toLowerCase()){case"textarea":case"select":return!0;case"input":switch(a.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!a.disabled&&!a.readOnly;default:return!1}},focus:function(a){var b,c=a.type;g&&a.setSelectionRange&&0!==c.indexOf("date")&&"time"!==c&&"month"!==c?(b=a.value.length,a.setSelectionRange(b,b)):a.focus()},findControl:function(a){return void 0!==a.control?a.control:a.htmlFor?document.getElementById(a.htmlFor):a.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},fixTarget:function(b){return 3===b.nodeType?b.parentNode:a.SVGElementInstance&&b instanceof SVGElementInstance?b.correspondingUseElement:b},updateScrollParent:function(a){var b=a.tapScrollParent;if(!b||!b.contains(a)){var c=a;do{if(c.scrollHeight>c.offsetHeight){b=c,a.tapScrollParent=c;break}c=c.parentElement}while(c)}b&&(b.lastScrollTop=b.scrollTop)},touchHasMoved:function(a){var b=a.changedTouches[0],c=k.touchBoundary;return Math.abs(b.pageX-k.touchStartX)>c||Math.abs(b.pageY-k.touchStartY)>c},findType:function(a){return f&&"select"===a.tagName.toLowerCase()?"mousedown":"click"},sendClick:function(b,c){h.fire(b,"tap",{touchEvent:c});var d,e;document.activeElement&&document.activeElement!==b&&document.activeElement.blur(),e=c.changedTouches[0],d=document.createEvent("MouseEvents"),d.initMouseEvent(k.findType(b),!0,!0,a,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),d.touchEvent=c,b.dispatchEvent(d)},touchstart:function(b){if(1!==b.targetTouches.length)return!0;var c=k.fixTarget(b.target),d=b.targetTouches[0];if(g){var e=a.getSelection();if(e.rangeCount&&!e.isCollapsed)return!0;var f=d.identifier;if(f&&isFinite(k.lastTouchIdentifier)&&k.lastTouchIdentifier===f)return b.preventDefault(),!1;k.lastTouchIdentifier=f,k.updateScrollParent(c)}k.status="tapping",k.startTime=Date.now(),k.element=c,k.pageX=d.pageX,k.pageY=d.pageY,k.startTime-k.lastTime<k.tapDelay&&b.preventDefault()},touchmove:function(a){return"tapping"!==k.status?!0:void((k.element!==k.fixTarget(a.target)||k.touchHasMoved(a))&&(k.status=k.element=0))},touchend:function(b){var c=k.element,d=Date.now();if(!c||d-k.startTime>k.tapDelay)return!0;k.lastTime=d;var e=k.startTime;if(k.status=k.startTime=0,targetTagName=c.tagName.toLowerCase(),"label"===targetTagName){h.fire(c,"tap",{touchEvent:b});var i=k.findControl(c);i&&(k.focus(c),c=i)}else if(k.needFocus(c))return d-e>100||g&&a.top!==a&&"input"===targetTagName?(k.element=0,!1):(k.focus(c),f&&k.sendClick(c,b),!1);if(g){var j=c.tapScrollParent;if(j&&j.lastScrollTop!==j.scrollTop)return!0}k.needClick(c)||(b.preventDefault(),k.sendClick(c,b))},touchcancel:function(){k.startTime=k.element=0}};h.add("tap",k);var l={events:["longtap","doubletap"],cancelPress:function(a){clearTimeout(a.pressingHandler),a.pressingHandler=null},touchstart:function(a){h.start(a,function(b,c){b.pressingHandler=setTimeout(function(){"tapping"===b.status&&h.fire(a.target,"longtap",{touch:c,touchEvent:a}),l.cancelPress(b)},500),1!==a.changedTouches.length&&(b.status=0)})},touchmove:function(a){h.move(a,function(a){a.distance>10&&a.pressingHandler&&(l.cancelPress(a),"tapping"===a.status&&(a.status="panning"))})},touchend:function(a){h.end(a,function(b,c){l.cancelPress(b),"tapping"===b.status&&(b.lastTime=Date.now(),l.lastTap&&b.lastTime-l.lastTap.lastTime<300&&h.fire(b.element,"doubletap",{touch:c,touchEvent:a}),l.lastTap=b)})},touchcancel:function(a){h.end(a,function(a){l.cancelPress(a)})}};h.add("press",l);var m={events:["swipe","swipeleft","swiperight","swipeup","swipedown"],getAngle:function(a,b){var c=Math.atan2(b,a),d=Math.round(180*c/Math.PI);return 0>d?360-Math.abs(d):d},getDirection:function(a,b){var c=m.getAngle(a,b);return 45>=c&&c>=0?"left":360>=c&&c>=315?"left":c>=135&&225>=c?"right":c>45&&135>c?"down":"up"},touchstart:function(a){h.start(a,e)},touchmove:function(a){h.move(a,e)},touchend:function(a){1===a.changedTouches.length&&h.end(a,function(b,c){var d=b.distance>30&&b.distance/b.duration>.65;if(d){var e={deltaX:b.deltaX,deltaY:b.deltaY,touch:c,touchEvent:a,direction:m.getDirection(b.deltaX,b.deltaY),isVertical:b.isVertical},f=b.element;h.fire(f,"swipe",e),h.fire(f,"swipe"+e.direction,e)}})}};m.touchcancel=m.touchend,h.add("swipe",m)},"function"==typeof define&&define.amd&&define("avalon",[],function(){return avalon});var zd=a.avalon;return avalon.noConflict=function(b){return b&&a.avalon===avalon&&(a.avalon=zd),avalon},void 0===b&&(a.avalon=avalon),avalon});